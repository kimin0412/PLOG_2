<template>
  <div>
      <div class="d-none d-sm-block">
        <div class="content-center mx-auto mt-10">
          <v-row>
            <v-col cols="12">
              <div class="text-center display-1 font-weight-light">Make your own Group</div>
            </v-col>
            <v-col cols="12" class="text-center grey--text mb-4">
                <v-container class="centercontent">
                    <v-row justify="center">
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text">Group Name</v-col>
                    <v-col cols="12" class="py-0 px-0">
                        <v-text-field
                        placeholder="Í∑∏Î£πÎ™ÖÏùÑ ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
                        filled
                        rounded
                        dense
                        v-model="groupname"
                        clearable
                        autofocus
                        ></v-text-field>            
                    </v-col>
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text mt-n3">Enter Code</v-col>
                    <v-col cols="12" class="py-0 px-0">
                        <v-text-field
                        placeholder="ÏûÖÏû• ÏΩîÎìúÎ•º ÏûÖÎ†•Ìï¥Ï£ºÏÑ∏Ïöî"
                        filled
                        rounded
                        dense
                        clearable
                        v-model="entercode"
                        ></v-text-field> 
                    </v-col>      
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text mt-n3">Introduction</v-col>
                    <v-col cols="12" class="py-0 px-0">
                        <v-textarea
                        filled
                        auto-grow
                        rows="4"
                        row-height="30"
                        v-model="groupintro"
                        placeholder="Í∑∏Î£πÏóê ÎåÄÌï¥ 150Ïûê Ïù¥ÎÇ¥Î°ú Í∞ÑÎã®Ìûà ÏÜåÍ∞úÌï¥Ï£ºÏÑ∏Ïöî"
                        :rules="[rules.counter]"
                        counter
                        rounded
                        maxlength="150"
                        ></v-textarea>
                    </v-col>   
                    </v-row>
                    <v-row class="my-2">
                        <v-col cols="1" class="px-0 pb-0 mx-0 my-0">
                            <v-card :color="groupcolor" class="py-2 transparent--text">ÏÉâ</v-card>
                        </v-col>
                        <v-col cols="11">
                            <v-select v-model="groupcolor"
                                        :items="colors"
                                        filled
                                        dense
                                        label="Í∑∏Î£πÏùÑ ÎåÄÌëúÌïòÎäî ÏÉâÍπîÏùÑ Í≥®ÎùºÏ£ºÏÑ∏Ïöî"
                                        full-width>
                            </v-select>
                        </v-col>
                    </v-row>
                    <v-row>
                    <v-btn @click="createGroup" rounded color="blue" dark block>Create Group</v-btn>
                    </v-row>
                    <v-row class="mt-2">
                    <v-col cols="8"></v-col>
                    <v-col cols="4" class="py-0 text-right"><router-link to="/group" class="text-decoration-none blue-darken-2--text text-caption linkto">‚óÄ ÎèåÏïÑÍ∞ÄÍ∏∞</router-link></v-col>
                    </v-row>
                </v-container>
            </v-col>
          </v-row>
        </div>
      </div>
      <div class="d-block d-sm-none">
        <v-container>
          <v-row>
            <v-col cols="12" class="py-1 text-h5">GROUP</v-col>
            <v-col cols="12" class="py-1 text-h4 font-weight-bold">Make group</v-col>
          </v-row>
          <v-row class="mt-5">
            <v-col cols="12" class="text-center grey--text mb-4">
                <v-container>
                    <v-row justify="center">
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text">Group Name</v-col>
                    <v-col cols="12" class="py-0 px-0">
                        <v-text-field
                        placeholder="Í∑∏Î£πÎ™Ö"
                        filled
                        rounded
                        dense
                        v-model="groupname"
                        clearable
                        autofocus
                        ></v-text-field>            
                    </v-col>
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text mt-n3">Enter Code</v-col>
                    <v-col cols="12" class="py-0 px-0">
                        <v-text-field
                        placeholder="ÏûÖÏû• ÏΩîÎìú"
                        filled
                        rounded
                        dense
                        clearable
                        v-model="entercode"
                        ></v-text-field> 
                    </v-col>      
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text mt-n3">Introduction</v-col>
                    <v-col cols="12" class="py-0 px-0">
                        <v-textarea
                        filled
                        auto-grow
                        rows="4"
                        row-height="20"
                        v-model="groupintro"
                        placeholder="150Ïûê Ïù¥ÎÇ¥"
                        :rules="[rules.counter]"
                        counter
                        rounded
                        maxlength="150"
                        ></v-textarea>
                    </v-col>   
                    </v-row>
                    <v-row class="my-2">
                        <v-col cols="2" class="px-0 pb-0 mx-0 my-0">
                            <v-card :color="groupcolor" class="py-2 transparent--text">ÏÉâ</v-card>
                        </v-col>
                        <v-col cols="10">
                            <v-select v-model="groupcolor"
                                        :items="colors"
                                        filled
                                        dense
                                        label="Í∑∏Î£πÏùÑ ÎåÄÌëúÌïòÎäî ÏÉâÍπîÏùÑ Í≥®ÎùºÏ£ºÏÑ∏Ïöî"
                                        full-width>
                            </v-select>
                        </v-col>
                    </v-row>
                    <v-row>
                    <v-btn @click="createGroup" small rounded color="blue" dark block>Create Group</v-btn>
                    </v-row>
                    <v-row class="mt-2">
                    <v-col cols="8"></v-col>
                    <v-col cols="4" class="py-0 text-right"><router-link to="/group" class="text-decoration-none blue-darken-2--text text-caption linkto">‚óÄ ÎèåÏïÑÍ∞ÄÍ∏∞</router-link></v-col>
                    </v-row>
                </v-container>
            </v-col>
          </v-row>
        </v-container>
      </div>
  </div>
</template>

<script>
import http from '@/util/http-common.js'
export default {
    name: 'GroupCreate',
    data() {
      return {
          groupname: '',
          entercode: '',
          groupintro:'',
          groupcolor: 'indigo',
          rules: {
            counter: value => value.length <= 150 || '150Ïûê Ïù¥ÎÇ¥',
          },
          colors: ['red', 'pink', 'purple', 'indigo', 'light-blue', 'green', 'lime', 'yellow', 'orange', 'brown', 'grey'],
      }
    },
    methods: {
        createGroup() {
            if (this.groupname.trim() === ''){
              this.$dialog.notify.warning("Í∑∏Î£πÎ™ÖÏùÄ ÌïÑÏàòÏûÖÎãàÎã§. üò•", {
                  position: "bottom-right",
                  timeout: 3000,
              });
            } else {
                if (this.entercode.trim() === ''){
                  this.$dialog.notify.warning("ÏûÖÏû• ÌôïÏù∏Ïö© ÎπÑÎ∞ÄÎ≤àÌò∏Î•º ÏÑ§Ï†ïÌï¥Ï£ºÏÑ∏Ïöî! üò•", {
                      position: "bottom-right",
                      timeout: 3000,
                  });
                } else {
                    if (this.groupintro.trim() === ''){
                        this.$dialog.notify.warning("ÏßßÏùÄ ÏÜåÍ∞ú Î∂ÄÌÉÅÎìúÎ¶ΩÎãàÎã§! üòÉ", {
                          position: "bottom-right",
                          timeout: 3000,
                      });
                    } else {
                        http.post('/club/insert', {
                          clId : this.$store.state.auth.user.id,
                          clName : this.groupname,
                          clInfo : this.groupintro,
                          clColor : this.groupcolor,
                          clPassword : this.entercode
                          // sColor : this.pickColor,
                        })
                        .then(({ data }) => {
                          let msg = "Îì±Î°ù Ï≤òÎ¶¨Ïãú Î¨∏Ï†úÍ∞Ä Î∞úÏÉùÌñàÏäµÎãàÎã§.";
                            if (data.data == "success") {
                              msg = "Îì±Î°ùÏù¥ ÏôÑÎ£åÎêòÏóàÏäµÎãàÎã§.";
                              this.$dialog.notify.success(msg + " üòÉ", {
                                position: "bottom-right",
                                timeout: 3000,
                              });
                            } else {
                              this.$dialog.notify.error(msg + " üò•", {
                                position: "bottom-right",
                                timeout: 3000,
                              });
                            }
                            this.$router.push("/group");
                        })
                        .catch((error) => {
                          if(error.response) {
                            this.$router.push("servererror")
                          } else if(error.request) {
                            this.$router.push("clienterror")
                          } else{
                            this.$router.push("/404");
                          }                          
                        })                
                    }
                }
            }
        }
  }
}
</script>

<style scoped>
.content-center {
  width: 85%;
}
.centercontent {
  width: 65%;
}
</style>