<template>
    <div>
        <div class="d-none d-sm-block">
            <div class="centercontent mx-auto">
            <v-container class="big-signupform">
                <v-row>
                    <v-col cols="12" class="py-1 display-2 font-weight-light text-center">Sign up</v-col>
                </v-row>
                <v-row justify="center" class="mt-7">
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5">UserID</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        v-model="user.username"
                        autofocus
                        ></v-text-field>            
                    </v-col>
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5 mt-n3">E-mail</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        v-model="user.email"
                        ></v-text-field>            
                    </v-col>
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5 mt-n3">Password</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="6ìë¦¬ ì´ìƒìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”."
                        filled
                        rounded
                        dense
                        type="password"
                        v-model="user.password"
                        ></v-text-field> 
                    </v-col>    
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5 mt-n3">Password í™•ì¸</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        type="password"
                        v-model="user.password2"
                        ></v-text-field> 
                    </v-col>     
                </v-row>
                <v-row class="px-3">
                    <v-btn @click="handleRegister" rounded color="blue" dark block>Sign up</v-btn>
                </v-row>
                <v-row class="px-5 mt-2">
                    <v-col cols="8" class="py-0 grey--text text-caption pt-1">ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”?</v-col>
                    <v-col cols="4" class="py-0 text-right"><router-link to="/login" class="text-caption linkto">Log in</router-link></v-col>
                </v-row>
            </v-container>
            </div>
        </div>
        <div class="d-block d-sm-none">
            <v-container>
                <v-row>
                    <v-col cols="12" class="py-1 text-h4 font-weight-bold blue--text">Sign up</v-col>
                </v-row>
                <v-row justify="center" class="mt-7">
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5">Username</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ì´ë¦„ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        v-model="user.username"
                        autofocus
                        ></v-text-field>            
                    </v-col>
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5 mt-n3">E-mail</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        v-model="user.email"
                        ></v-text-field>            
                    </v-col>
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5 mt-n3">Password</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        type="password"
                        v-model="user.password"
                        ></v-text-field> 
                    </v-col>    
                    <v-col cols="12" class="py-1 text-subtitle-2 grey--text pl-5 mt-n3">Password í™•ì¸</v-col>
                    <v-col cols="12" class="py-0">
                        <v-text-field
                        placeholder="ë¹„ë°€ë²ˆí˜¸ë¥¼ í™•ì¸í•´ì£¼ì„¸ìš”"
                        filled
                        rounded
                        dense
                        type="password"
                        v-model="user.password2"
                        ></v-text-field> 
                    </v-col>     
                </v-row>
                <v-row class="px-3">
                    <v-btn @click="handleRegister" rounded color="blue" dark block>Sign up</v-btn>
                </v-row>
                <v-row class="px-5 mt-2">
                    <v-col cols="8" class="py-0 grey--text text-caption pt-1">ì´ë¯¸ ê³„ì •ì´ ìˆìœ¼ì‹ ê°€ìš”?</v-col>
                    <v-col cols="4" class="py-0 text-center"><router-link to="/login" class="text-caption linkto">ë¡œê·¸ì¸ í•˜ê¸°</router-link></v-col>
                </v-row>
            </v-container>
        </div>
    </div>
</template>
<!--
<script>
export default {
    name: 'signup',
    data() {
        return{
            username: '',
            useremail: '',
            userpassword: '',
            userpassword2: '',
        }
    },
    methods: {
        sendSignupData() {
            if (!this.username||!this.useremail||!this.userpassword||!this.userpassword2) {
                alert('ëª¨ë“  í•­ëª©ì€ í•„ìˆ˜ë¡œ ì…ë ¥í•´ì•¼ í•©ë‹ˆë‹¤.')
            } else {
                if (this.username.length > 15) {
                    alert('ì´ë¦„ì€ ìµœì†Œ 3ê¸€ì ì´ìƒ 15ê¸€ì ë¯¸ë§Œì´ì–´ì•¼ í•©ë‹ˆë‹¤')
                } else if (this.username.length < 3) {
                    alert('ì´ë¦„ì€ ìµœì†Œ 3ê¸€ì ì´ìƒ 15ê¸€ì ë¯¸ë§Œì´ì–´ì•¼ í•©ë‹ˆë‹¤')
                } else {
                    if (!/.+@.+\..+/.test(this.useremail)) {
                        alert('ì´ë©”ì¼ í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”. ì˜ˆì‹œ) example@example.com')
                    } else {
                        if (this.userpassword.length < 8) {
                            alert('ë¹„ë°€ë²ˆí˜¸ëŠ” ìµœì†Œ 8ê¸€ì ì´ìƒì´ì–´ì•¼í•©ë‹ˆë‹¤.')
                        } else {
                            if (this.userpassword !== this.userpassword2) {
                                alert('ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.')
                            } else {
                                alert('ì„±ê³µ') //ë‚˜ì¤‘ì— ì½”ë“œ ì§€ì›Œì•¼ í•¨
                                //ìš”ì²­ ë³´ë‚´ê¸°
                            }
                        }
                    }
                }
            }
        }
    }
}
</script>
-->

<script>
import User from '../../models/user';

export default {
  name: 'Register',
  data() {
    return {
      user: new User('', '', ''),
      submitted: false,
      successful: false,
      password2:'',
      message: '',
    };
  },
  computed: {
    loggedIn() {
      return this.$store.state.auth.status.loggedIn;
    }
  },
  mounted() {
    if (this.loggedIn) {
      this.$router.push('/profile');
    }
  },
  methods: {
    handleRegister() {
      if (this.user.password.length < 6) {
        this.$dialog.notify.warning("ë¹„ë°€ë²ˆí˜¸ëŠ” 6ìë¦¬ ì´ìƒì´ì–´ì•¼ í•©ë‹ˆë‹¤ ğŸ˜¤", {
        position: "bottom-right",
        timeout: 3000,
        });
      } else if (this.user.password !== this.user.password2) {
        //   console.log(this.user.password)
        //   console.log(this.user.password2)
            this.$dialog.notify.error("ë¹„ë°€ë²ˆí˜¸ê°€ ì¼ì¹˜í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤ ğŸ˜¥", {
            position: "bottom-right",
            timeout: 3000,
            });
      } else {
        this.message = '';
        this.submitted = true;
        this.$validator.validate().then(isValid => {
            if (isValid) {
            this.$store.dispatch('auth/register', this.user).then(
                data => {
                this.message = data.message;
                this.successful = true;
                this.$router.push('signup/success');
                },
                error => {
                this.message =
                    (error.response && error.response.data) ||
                    error.message ||
                    error.toString();
                this.successful = false;
                }
            );
            }
        });
      }
    }
  }
};
</script>
<style scoped>
.linkto {
  text-decoration: none;
  color: rgb(67, 119, 196);
}
.centercontent {
  width: 35%;
}
.big-signupform {
  margin-top: 15vh; 
}
</style>